.TH SPRAT-CLI 1 "February 2026" "sprat-cli" "User Commands"
.SH NAME
sprat-cli \- sprite atlas layout and packing pipeline
.SH SYNOPSIS
.B spratlayout
.I folder
[\fB\-\-profile\fR \fINAME\fR]
[\fB\-\-profiles\-config\fR \fIPATH\fR]
[\fB\-\-mode\fR compact|pot|fast]
[\fB\-\-optimize\fR gpu|space]
[\fB\-\-max\-width\fR \fIN\fR]
[\fB\-\-max\-height\fR \fIN\fR]
[\fB\-\-padding\fR \fIN\fR]
[\fB\-\-max\-combinations\fR \fIN\fR]
[\fB\-\-source\-resolution\fR \fIWxH\fR]
[\fB\-\-target\-resolution\fR \fIWxH\fR]
[\fB\-\-resolution\-reference\fR largest|smallest]
[\fB\-\-scale\fR \fIF\fR]
[\fB\-\-trim\-transparent\fR]
[\fB\-\-no\-trim\-transparent\fR]
[\fB\-\-threads\fR \fIN\fR]
.PP
.B spratpack
[\fB\-\-frame\-lines\fR]
[\fB\-\-line\-width\fR \fIN\fR]
[\fB\-\-line\-color\fR \fIR,G,B[,A]\fR]
[\fB\-\-threads\fR \fIN\fR]
.PP
.B spratconvert
[\fB\-\-transform\fR \fINAME|PATH\fR]
[\fB\-\-list\-transforms\fR]
.SH DESCRIPTION
\fBsprat\-cli\fR is a UNIX pipeline for generating sprite sheets and transforming layout metadata.
.PP
\fBspratlayout\fR scans an image folder and writes a text layout to standard output.
.PP
\fBspratpack\fR reads the layout from standard input and writes a PNG atlas to standard output.
.PP
\fBspratconvert\fR reads the same layout format from standard input and transforms it into text formats (for example JSON, CSV, XML, CSS) using template-driven transforms.
.PP
Normal output is written to stdout. Errors are written to stderr.
.SH COMMANDS
.SS spratlayout
Reads image metadata from files in \fIfolder\fR and prints layout lines:
.PP
atlas \fIwidth,height\fR
.br
scale \fIfactor\fR
.br
sprite "\fIpath\fR" \fIx,y\fR \fIw,h\fR [\fIleft,top right,bottom\fR]
.PP
If \fB\-\-trim\-transparent\fR is enabled, trim offsets are included per sprite.
.PP
If \fIfolder\fR is actually a text file, it is treated as a newline-delimited list of image paths (comments starting with \fB#\fR and blank lines are ignored). Relative paths are resolved relative to the list file, and each path must point to an existing image or the command fails.
.PP
Profile configuration is loaded from the first existing file in this order:
.IP "\(bu" 2
\fB\-\-profiles\-config\fR path (when provided)
.IP "\(bu" 2
\fB~/.config/sprat/spratprofiles.cfg\fR
.IP "\(bu" 2
\fBspratprofiles.cfg\fR in the same directory as \fBspratlayout\fR
.IP "\(bu" 2
Global installed config (typically \fB/usr/local/share/sprat/spratprofiles.cfg\fR)
.PP
Profile values act as defaults; CLI options override them per run.
.PP
Performance cache:
.IP "\(bu" 2
Metadata and output caches are stored in the system temp directory.
.IP "\(bu" 2
Unchanged inputs/options reuse cached results.
.IP "\(bu" 2
Entries older than one hour are pruned automatically.
.SS spratpack
Reads layout text from stdin and writes a PNG stream to stdout.
.PP
Layout accepts:
.br
atlas \fIwidth,height\fR (or legacy \fIatlas width height\fR)
.br
scale \fIfactor\fR
.br
sprite lines in current or legacy numeric format
.SS spratconvert
Reads layout text from stdin and writes transformed text to stdout.
.PP
Transforms can be selected by name from \fBtransforms/\fR (for example \fBjson\fR, \fBcsv\fR, \fBxml\fR, \fBcss\fR) or by path to a custom \fB.transform\fR file.
Optional \fB\-\-markers\fR and \fB\-\-animations\fR files can be loaded and referenced by transform placeholders.
Transform sections use explicit open/close tags (for example \fB[meta]\fR ... \fB[/meta]\fR).
Sprite iteration is defined as \fB[sprites]\fR containing \fB[sprite]\fR; animation iteration as \fB[animations]\fR containing \fB[animation]\fR; marker iteration as \fB[markers]\fR containing \fB[marker]\fR.
Templates support marker/animation conditional sections (\fB[if_markers]\fR, \fB[if_no_markers]\fR, \fB[if_animations]\fR, \fB[if_no_animations]\fR) and optional separator/header/footer sections.
Sprite placeholders include \fB{{name}}\fR (basename without extension), and marker loop placeholders include \fB{{marker_name}}\fR plus sprite association fields (\fB{{marker_sprite_index}}\fR, \fB{{marker_sprite_name}}\fR).
Animation loop placeholders include \fB{{animation_name}}\fR and \fB{{animation_sprite_indexes_json}}\fR.
Built-in JSON transform output omits \fBindex\fR fields from \fBsprites[]\fR and \fBanimations[]\fR.
.SH OPTIONS
.SS spratlayout
.TP
\fB\-\-profile\fR \fINAME\fR
Profile name loaded from profile config. Default: \fBfast\fR.
.TP
\fB\-\-profiles\-config\fR \fIPATH\fR
Use an explicit profile configuration file.
.TP
\fB\-\-mode\fR compact|pot|fast
Override packing mode from selected profile.
.TP
\fB\-\-optimize\fR gpu|space
Override optimization target from selected profile.
.TP
\fB\-\-max\-width\fR \fIN\fR
Maximum atlas width. Overrides profile value.
.TP
\fB\-\-max\-height\fR \fIN\fR
Maximum atlas height. Overrides profile value.
.TP
\fB\-\-padding\fR \fIN\fR
Extra pixels between packed sprites. Overrides profile value.
.TP
\fB\-\-max\-combinations\fR \fIN\fR
Maximum number of compact candidate combinations to test (\fB0\fR means auto/unlimited). Overrides profile value.
.TP
\fB\-\-source\-resolution\fR \fIWxH\fR
Source design resolution baseline (for example \fB800x600\fR). Must be used together with \fB\-\-target\-resolution\fR.
.TP
\fB\-\-target\-resolution\fR \fIWxH\fR
Target output resolution (for example \fB800x600\fR). Must be used together with \fB\-\-source\-resolution\fR.
.TP
\fB\-\-resolution\-reference\fR largest|smallest
Choose which axis ratio drives source/target resolution scaling. Default: \fBlargest\fR.
.TP
\fB\-\-scale\fR \fIF\fR
Pre-scale factor applied before source/target resolution mapping. Valid range: \fB0 < F <= 1\fR. Overrides profile value.
.TP
\fB\-\-trim\-transparent\fR
Enable transparent-border trimming (overrides profile value).
.TP
\fB\-\-no\-trim\-transparent\fR
Disable transparent-border trimming (overrides profile value).
.TP
\fB\-\-threads\fR \fIN\fR
Worker thread count for compact profile search. Overrides profile value.
.PP
Config keys available per profile section:
.IP "\(bu" 2
\fBmode=compact|pot|fast\fR
.IP "\(bu" 2
\fBoptimize=gpu|space\fR
.IP "\(bu" 2
\fBmax_width\fR, \fBmax_height\fR
.IP "\(bu" 2
\fBpadding\fR, \fBmax_combinations\fR
.IP "\(bu" 2
\fBscale\fR (\fB0 < scale <= 1\fR), \fBtrim_transparent\fR, \fBthreads\fR
.SS spratpack
.TP
\fB\-\-frame\-lines\fR
Draw rectangle outlines for each sprite.
.TP
\fB\-\-line\-width\fR \fIN\fR
Outline thickness in pixels. Default: \fB1\fR.
.TP
\fB\-\-line\-color\fR \fIR,G,B[,A]\fR
Outline color channels (0-255). Default: \fB255,0,0,255\fR.
.TP
\fB\-\-threads\fR \fIN\fR
Worker thread count for sprite decode/blit. Used when sprite rectangles do not overlap. Default: auto.
.SS spratconvert
.TP
\fB\-\-transform\fR \fINAME|PATH\fR
Transform name from \fBtransforms/\fR or path to a custom transform file. Default: \fBjson\fR.
.TP
\fB\-\-list\-transforms\fR
Print available transforms and exit.
.TP
\fB\-\-markers\fR \fIPATH\fR
Load external markers text and expose it to transform placeholders.
Markers JSON expects \fB{"sprites":{...}}\fR with per-sprite \fBmarkers\fR arrays of objects (not strings), each with at least \fBname\fR and \fBtype\fR.
Supported marker types: \fBpoint\fR (\fBx\fR,\fBy\fR), \fBcircle\fR (\fBx\fR,\fBy\fR,\fBradius\fR), \fBrectangle\fR (\fBx\fR,\fBy\fR,\fBw\fR,\fBh\fR), \fBpolygon\fR (\fBvertices\fR list of \fB{x,y}\fR).
.TP
\fB\-\-animations\fR \fIPATH\fR
Load external animations text and expose it to transform placeholders.
.SH EXAMPLES
.TP
Generate layout text:
.B spratlayout ./frames > layout.txt
.TP
Pack PNG from layout:
.B spratpack < layout.txt > spritesheet.png
.TP
Transform layout to JSON:
.B spratconvert --transform json < layout.txt > layout.json
.TP
Transform layout with custom template:
.B spratconvert --transform ./my.transform < layout.txt > layout.custom.txt
.TP
Transform layout with extra files:
.B spratconvert --transform json --markers markers.json --animations animations.json < layout.txt > layout.json
.TP
Run as one pipeline:
.B spratlayout ./frames --trim-transparent --padding 2 | spratpack > spritesheet.png
.TP
Debug frame bounds:
.B spratpack --frame-lines --line-width 2 --line-color 0,255,0 < layout.txt > spritesheet_lines.png
.TP
Limit worker threads:
.B spratlayout ./frames --threads 4 > layout.txt ; spratpack --threads 4 < layout.txt > spritesheet.png
.SH EXIT STATUS
All commands return:
.TP
\fB0\fR
Success.
.TP
\fB1\fR
Invalid arguments, invalid input data, image decode/encode failure, or packing failure.
.SH SEE ALSO
\fBspratlayout\fR(1), \fBspratpack\fR(1), \fBspratconvert\fR(1)
